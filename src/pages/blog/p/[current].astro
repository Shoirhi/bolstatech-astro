---
import BlogsLayout from "@/layouts/BlogsLayout.astro";
import { getBlogList } from "@/libs/microcms";
import { LIMIT } from "@/constants";
import ArticleList from "@/components/ArticleList.astro";
const params = Astro.params;

export async function getStaticPaths() {
  const data = await getBlogList({
    limit: LIMIT,
  });
  const pageCount = Math.ceil(data.totalCount / LIMIT);

  return Array.from({ length: pageCount }).map((_, index) => ({
    params: {
      current: (index + 1).toString(),
    },
  }));
}

const current = parseInt(params.current as string, 10);

const data = await getBlogList({
  limit: LIMIT,
  offset: LIMIT * (current - 1),
});
---

<BlogsLayout>
  <ArticleList articles={data.contents} />
</BlogsLayout>
